build:
  tasks:
    - name: build C binary
      commands:
        - gcc -o $CDT_BUILD_DIR/bin/cryptdatum cryptdatum.c cmd/cryptdatum.c
      outputs:
        - $CDT_BUILD_DIR/bin/cryptdatum

tests:
  tasks:
    - name: test C library
      commands:
        - gcc -o $CDT_BUILD_DIR/bin/cryptdatum-test cryptdatum.c cryptdatum_test.c
        - $CDT_BUILD_DIR/bin/cryptdatum-test
      outputs:
        - $CDT_BUILD_DIR/bin/cryptdatum-test

binary:
  bin: $CDT_BUILD_DIR/bin/cryptdatum
  commands:
    - file-has-header
    - file-has-valid-header
    - file-has-invalid-header
    - file-info